
@{
    ViewBag.Title = "TestXmlJs";
}

@Scripts.Render("~/bundles/jquery")
@Scripts.Render("~/bundles/dweb")
<script type="text/javascript">
    $(document).ready(function () {
        var live = false;

        //$(document).ajaxStart(function () {
        //    console.log("Ajax starting!");
        //    $("#loading").show();
        //}).ajaxStop(function () {
        //    console.log("Ajax finished!");
        //    $("#loading").hide();
        //});

        $("#btnSubmit").click(function () {
            TranslateText();
            return true;
        }); 

        $("#btnPrint").click(function () {
            GetPrintPage();
            return true;
        }); 

        $("#chkLive").click(function () {
            if (!live)
                live = true;
            else if (live)
                live = false;
            return true;
        }); 

            $("#txtInput").keyup(function () {
                if (live) {
                    TranslateText();
                    return true;
                }
            });
    });    
    function TranslateText() {
        
        console.log("Ajax starting!");
        //$("#loading").show();
        //$("#loading").setAttribute("hidden", "none");
        $("#loading").innerHTML = "Loading...";
        //var inputText = $("#txtInput").val();
        var inputText = document.getElementById("txtInput").value;
            var output = HihapanesuTranslate(inputText);
            var outputElem = document.getElementById("output");
            outputElem.innerHTML = output;
        //$("#loading").hide();
        //$("#loading").setAttribute("hidden", "hidden");
        $("#loading").innerHTML = "";
        console.log("Ajax finished!");
            //$("#output").val(output);
        return 0;
    };

    function GetPrintPage() {
        debugger;
        //var url = $("#RedirectTo").val();
        //var svgData = encodeURI(document.getElementById("output").innerHTML);
        //var svgData = document.getElementById("output").innerHTML;
        //var encodedSvgData = htmlEscape(svgData);
        //var dataObject = { Data: svgData };
        //var dataObject = { Data: "hej" };
        //var dataJson = JSON.stringify(dataObject);
        //var response = $.ajax({
        //    contentType: 'application/json',
        //    data: dataJson,
        //    type: 'POST',
        //    url: url,
        //    async: false,
        //    success: function (result) {
        //        debugger;
        //            location.href = url;
        //    },
        //    failure: function (data) {
        //        debugger;
        //        console.log(data);
        //    }
            
        //});
        //console.log(response.responseText);
        //window.open(encodedSvgData, "__new", "width=1000,height=1000");
        PrintElem("output");
    }
</script>
@section Scripts
{
    
    }

<h2>TestXmlJs</h2>

<div class="row">
    <div class="col-md-6">
        <div>
            <textarea id="txtInput" rows="30" cols="300" style="width:300px;"></textarea>
            <span>
                <label for="chkLive">Live översättning</label>
                <input type="checkbox" id="chkLive" name="chkLive" />
            </span>
            <span><a id="btnSubmit" class="btn btn-info">Skapa</a></span>
            <span><a id="btnPrint" class="btn btn-info">Skriv</a></span>
            @Html.Hidden("RedirectTo", Url.Action("Print", "Print", new { Area = "PrintArea" }))
        </div>
    </div>
    <div class="col-md-6">
        <div id="loading" style="display:none"><h1>Laddar...</h1></div>
        <div id="output"></div>
    </div>
</div>
@*<script type="text/javascript" src="~/Scripts/TranslateScripts.js"></script>*@
@*<script type="text/javascript" src="~/Scripts/jquery-1.10.2.min.js"></script>*@

